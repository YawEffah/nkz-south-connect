{% load share_tags %}

<div class="share-container">
    <!-- Copy URL Button -->
    <button class="share-btn copy-btn" onclick="copyToClipboard('{{ request.build_absolute_uri }}')" 
            title="Copy link to clipboard">
        <i class="fas fa-copy"></i>
    </button>
    
    <!-- Social Share Buttons -->
    <a href="{% social_share_url 'facebook' %}" target="_blank" class="share-btn facebook" 
       title="Share on Facebook">
        <i class="fab fa-facebook-f"></i>
    </a>
    <a href="{% social_share_url 'twitter' %}" target="_blank" class="share-btn twitter"
       title="Share on Twitter">
        <i class="fab fa-twitter"></i>
    </a>
    <a href="{% social_share_url 'linkedin' %}" target="_blank" class="share-btn linkedin"
       title="Share on LinkedIn">
        <i class="fab fa-linkedin-in"></i>
    </a>
    <a href="{% social_share_url 'whatsapp' %}" target="_blank" class="share-btn whatsapp"
       title="Share on WhatsApp">
        <i class="fab fa-whatsapp"></i>
    </a>
    
    <!-- Web Share API Button (Mobile) -->
    <button class="share-btn web-share" onclick="webShare('{{ request.build_absolute_uri }}')" 
            title="Share via...">
        <i class="fas fa-share-alt"></i>
    </button>
</div>

<!-- Toast Notification (hidden by default) -->
<div id="share-toast" class="share-toast">Link copied to clipboard!</div>

<script>
// Modern clipboard API with fallback
function copyToClipboard(url) {
    navigator.clipboard.writeText(url).then(() => {
        showToast();
    }).catch(() => {
        // Fallback for older browsers
        const tempInput = document.createElement('input');
        tempInput.value = url;
        document.body.appendChild(tempInput);
        tempInput.select();
        document.execCommand('copy');
        document.body.removeChild(tempInput);
        showToast();
    });
}

// Web Share API for mobile devices
function webShare(url) {
    if (navigator.share) {
        navigator.share({
            title: document.title,
            url: url
        }).catch(err => {
            console.log('Error sharing:', err);
            copyToClipboard(url);
        });
    } else {
        copyToClipboard(url);
    }
}

// Toast notification
function showToast() {
    const toast = document.getElementById('share-toast');
    toast.classList.add('show');
    setTimeout(() => {
        toast.classList.remove('show');
    }, 3000);
}
</script>

<style>
.share-container {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.share-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    cursor: pointer;
    border: none;
    font-size: 16px;
    transition: transform 0.2s;
}

.share-btn .fab,
.share-btn .fas{
    color: white;
}

.share-btn:hover {
    transform: scale(1.1);
}

.copy-btn { background-color: #6c757d; }
.facebook { background-color: #3b5998; }
.twitter { background-color: #1da1f2; }
.linkedin { background-color: #0077b5; }
.whatsapp { background-color: #25d366; }
.web-share { background-color: #4285f4; }

.share-toast {
    visibility: hidden;
    min-width: 250px;
    background-color: #026C3B;
    color: #fff;
    text-align: center;
    border-radius: 4px;
    padding: 12px;
    position: fixed;
    z-index: 1000;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    opacity: 0;
    transition: opacity 0.5s;
}

.share-toast.show {
    visibility: visible;
    opacity: 1;
}
</style>